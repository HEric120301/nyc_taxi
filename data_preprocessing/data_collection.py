import sqlite3import csvimport osfolder_path = os.path.dirname(os.path.abspath(__file__))db = 'taxi.db'# taxi_data = '../data/green_tripdata_2017-01.csv'tables = [['green_tripdata_2017_01','../data/green_tripdata_2017-01.csv'],			['yellow_tripdata_2017_01','../data/yellow_tripdata_2017-01.csv']]def create_db(table_name):	print ("Opened database successfully")	conn.execute('DROP TABLE IF EXISTS '+table_name)	conn.execute('CREATE TABLE '+table_name+' (VendorID TEXT, lpep_pickup_datetime TIME)')	print ("Table created successfully")def data_collection(table_name, data_add):	create_db(table_name)	k=0	with open(data_add, newline='') as csvfile:		spamreader = csv.reader(csvfile, delimiter=',', quotechar='|')		for row in spamreader:			if k == 0:				k+=1				continue			if row!=[]:				k+=1				if not k%100000:					print(k/100000)				# sql_text = "INSERT INTO green_2017_01 (VendorID, lpep_pickup_datetime) VALUES("+row[0]+", "+row[1]+")"				cur.execute('insert into '+table_name+' values (?,?)', [row[0], row[1]])				# print((row))	print(k)if __name__ == "__main__":	conn = sqlite3.connect(db)	cur = conn.cursor()	for tb in tables:		data_collection(tb[0], tb[1])	conn.commit()	conn.close()